{"version":3,"sources":["../../../src/actions/index.js"],"names":["loginUser","authError","logoutUser","fetchMessage","API_URL","interceptors","request","use","config","token","localStorage","getItem","url","indexOf","headers","error","Promise","reject","response","res","data","message","push","console","log","email","password","dispatch","post","then","type","setItem","catch","payload","removeItem","get","authorization"],"mappings":";;;;;QAwCgBA,S,GAAAA,S;QAeAC,S,GAAAA,S;QAOAC,U,GAAAA,U;QAMAC,Y,GAAAA,Y;;AApEhB;;;;AACA;;AACA;;;;AAOA,IAAMC,UAAU,EAAhB;;AAEA,gBAAMC,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CAA+B,UAAUC,MAAV,EAAkB;AAC7C;AACA,QAAMC,QAAQC,aAAaC,OAAb,CAAqB,OAArB,CAAd;AACA,QAAKH,OAAOI,GAAP,CAAWC,OAAX,CAAmBT,OAAnB,MAAgC,CAAjC,IAAwCK,KAA5C,EAAmD;AAC/CD,eAAOM,OAAP,CAAe,gBAAf,IAAmCL,KAAnC;AACH;AACD,WAAOD,MAAP;AACH,CAPD,EAOG,UAAUO,KAAV,EAAiB;AAChB;AACA,WAAOC,QAAQC,MAAR,CAAeF,KAAf,CAAP;AACH,CAVD;;AAaA,gBAAMV,YAAN,CAAmBa,QAAnB,CAA4BX,GAA5B,CAAgC,UAAUY,GAAV,EAAe;AAC3C;AACA,QAAMV,QAAQC,aAAaC,OAAb,CAAqB,OAArB,CAAd;AACA,QAAGQ,IAAIC,IAAJ,CAASC,OAAT,IAAoB,8BAAvB,EAAsD;AAClD,oCAAeC,IAAf,CAAoB,QAApB;AACH,KAFD,MAGK,IAAGH,IAAIX,MAAJ,CAAWI,GAAX,CAAeC,OAAf,CAAuBT,OAAvB,MAAoC,CAApC,IAAyCe,IAAIC,IAAJ,CAASX,KAArD,EAA4D;AAC7Dc,gBAAQC,GAAR,CAAYL,IAAIC,IAAJ,CAASX,KAArB;AACH;AACD,WAAOS,QAAP;AACH,CAVD,EAUG,UAAUH,KAAV,EAAiB;AAChB;AACA,gCAAeO,IAAf,CAAoB,QAApB;AACA,WAAON,QAAQC,MAAR,CAAeF,KAAf,CAAP;AACH,CAdD;;AAgBO,SAASf,SAAT,OAAqC;AAAA,QAAjByB,KAAiB,QAAjBA,KAAiB;AAAA,QAAVC,QAAU,QAAVA,QAAU;;AACxC,WAAO,UAASC,QAAT,EAAkB;AACrB,wBAAMC,IAAN,CAAcxB,OAAd,oBAAsC,EAACqB,YAAD,EAAQC,kBAAR,EAAtC,EACKG,IADL,CACU,oBAAW;AACbN,oBAAQC,GAAR,CAAYN,SAASJ,OAArB;AACAa,qBAAS,EAACG,sBAAD,EAAT;AACApB,yBAAaqB,OAAb,CAAqB,OAArB,EAA8Bb,SAASE,IAAT,CAAcX,KAA5C;AACA,wCAAea,IAAf,CAAoB,UAApB;AACH,SANL,EAOKU,KAPL,CAOW,YAAK;AACRL,qBAAS1B,UAAU,gBAAV,CAAT;AACH,SATL;AAUH,KAXD;AAYH;;AAEM,SAASA,SAAT,CAAmBc,KAAnB,EAAyB;AAC5B,WAAO;AACHe,+BADG;AAEHG,iBAASlB;AAFN,KAAP;AAIH;;AAEM,SAASb,UAAT,GAAsB;AACzBQ,iBAAawB,UAAb,CAAwB,OAAxB;;AAEA,WAAO,EAACJ,wBAAD,EAAP;AACH;;AAEM,SAAS3B,YAAT,GAAwB;AAC3B,WAAO,UAAUwB,QAAV,EAAoB;AACvB,wBAAMQ,GAAN,CAAU/B,OAAV,EAAmB;AACfU,qBAAQ;AACJsB,+BAAe1B,aAAaC,OAAb,CAAqB,OAArB;AADX;AADO,SAAnB,EAKKkB,IALL,CAKU,oBAAW;AACbF,qBAAS;AACLG,0CADK;AAELG,yBAASf,SAASE,IAAT,CAAcC;AAFlB,aAAT;AAIH,SAVL;AAWH,KAZD;AAaH","file":"index.js","sourcesContent":["import axios from 'axios';\nimport { browserHistory } from 'react-router';\nimport {\n    AUTH_USER,\n    UNAUTH_USER,\n    AUTH_ERROR,\n    FETCH_MESSAGE\n} from './types';\n\nconst API_URL = '';\n\naxios.interceptors.request.use(function (config) {\n    // Do something before request is sent\n    const token = localStorage.getItem('token');\n    if( (config.url.indexOf(API_URL) === 0 ) && token) {\n        config.headers['x-access-token'] = token;\n    }\n    return config;\n}, function (error) {\n    // Do something with request error\n    return Promise.reject(error);\n});\n\n\naxios.interceptors.response.use(function (res) {\n    // Do something with response data\n    const token = localStorage.getItem('token');\n    if(res.data.message == 'Failed to authenticate token'){\n        browserHistory.push('/login');\n    }\n    else if(res.config.url.indexOf(API_URL) === 0 && res.data.token) {\n        console.log(res.data.token);\n    }\n    return response;\n}, function (error) {\n    // Do something with response error\n    browserHistory.push('/login');\n    return Promise.reject(error);\n});\n\nexport function loginUser({email, password}){\n    return function(dispatch){\n        axios.post(`${API_URL}/authenticate`, {email, password})\n            .then(response =>{\n                console.log(response.headers);\n                dispatch({type: AUTH_USER});\n                localStorage.setItem('token', response.data.token);\n                browserHistory.push('/feature');\n            })\n            .catch(() =>{\n                dispatch(authError('Bad Login Info'));\n            })\n    }\n}\n\nexport function authError(error){\n    return {\n        type: AUTH_ERROR,\n        payload: error\n    }\n}\n\nexport function logoutUser() {\n    localStorage.removeItem('token');\n\n    return {type: UNAUTH_USER};\n}\n\nexport function fetchMessage() {\n    return function (dispatch) {\n        axios.get(API_URL, {\n            headers:{\n                authorization: localStorage.getItem('token')\n            }\n        })\n            .then(response =>{\n                dispatch({\n                    type: FETCH_MESSAGE,\n                    payload: response.data.message\n                })\n            })\n    }\n}"]}